"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports["default"]=void 0;var _Config=_interopRequireDefault(require("./Config")),_Theme=_interopRequireWildcard(require("./Theme")),_fsExtra=_interopRequireDefault(require("fs-extra")),_Peripherals=_interopRequireDefault(require("./Peripherals")),_env=_interopRequireDefault(require("./env")),_Output=_interopRequireDefault(require("./Output")),_Model=_interopRequireDefault(require("./Model")),_Template=_interopRequireDefault(require("./Template")),_nunjucks=_interopRequireDefault(require("nunjucks"));function _interopRequireWildcard(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)if(Object.prototype.hasOwnProperty.call(a,c)){var d=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(a,c):{};d.get||d.set?Object.defineProperty(b,c,d):b[c]=a[c]}return b["default"]=a,b}function _interopRequireDefault(a){return a&&a.__esModule?a:{default:a}}function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function _defineProperties(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}function _createClass(a,b,c){return b&&_defineProperties(a.prototype,b),c&&_defineProperties(a,c),a}var nunjucksEnv=_nunjucks["default"].configure(),files=[],things=[],Mole=/*#__PURE__*/function(){function a(){_classCallCheck(this,a)}return _createClass(a,[{key:"config",value:function config(a){_Config["default"].set(a)}},{key:"theme",value:function theme(a){_Theme["default"].set(a,_Config["default"])}},{key:"create",value:function create(){if("model"===(0>=arguments.length?void 0:arguments[0])){var a=new _Model["default"](1>=arguments.length?void 0:arguments[1],2>=arguments.length?void 0:arguments[2],_Theme["default"],_Theme.data);_Peripherals["default"].model.push(a),_Theme.data.update(a.data)}"template"===(0>=arguments.length?void 0:arguments[0])&&_Peripherals["default"].template.push(new _Template["default"](1>=arguments.length?void 0:arguments[1],2>=arguments.length?void 0:arguments[2],_Theme["default"],_Theme.data)),this._outputs()}// An alias for create, add() is depreciated */
},{key:"add",value:function add(){this.create.apply(this,arguments)}},{key:"_outputs",value:function _outputs(){things=_Config["default"].output.map(function(a){return new _Output["default"](a,_Peripherals["default"],_Config["default"],_Theme["default"],_Theme.data)})}},{key:"render",value:function render(){var a=!0,b=!1,c=void 0;try{for(var d,e=things[Symbol.iterator]();!(a=(d=e.next()).done);a=!0){var f=d.value,g={content:nunjucksEnv.renderString(f.template,f.model),path:f.path};files.push(g)}}catch(a){b=!0,c=a}finally{try{a||null==e["return"]||e["return"]()}finally{if(b)throw c}}}},{key:"build",value:function build(){this._outputs(),this.render();for(var a=function(){var a=c[b];_fsExtra["default"].outputFile(a.path,a.content,function(b){b&&console.log(b),"test"===_env["default"]&&_fsExtra["default"].readFile(a.path,"utf8",function(a,b){console.log(b)})})},b=0,c=files;b<c.length;b++)a()}}]),a}(),mole=new Mole;"test"===_env["default"]&&mole.build(),mole.debug={config:_Config["default"],theme:_Theme["default"],data:_Theme.data,outputs:_Config["default"].output,files:files,things:things// console.log(mole.debug)
};var _default=mole;exports["default"]=_default,module.exports=exports.default;